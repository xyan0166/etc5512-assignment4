<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Xinran Yang">

<title>Who is Reporting Crime? –An Analysis of NIBRS System Capture Participation Rate Maps Across the U.S.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="assignment4_template_Xinran_Yang_34294384_files/libs/clipboard/clipboard.min.js"></script>
<script src="assignment4_template_Xinran_Yang_34294384_files/libs/quarto-html/quarto.js"></script>
<script src="assignment4_template_Xinran_Yang_34294384_files/libs/quarto-html/popper.min.js"></script>
<script src="assignment4_template_Xinran_Yang_34294384_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="assignment4_template_Xinran_Yang_34294384_files/libs/quarto-html/anchor.min.js"></script>
<link href="assignment4_template_Xinran_Yang_34294384_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="assignment4_template_Xinran_Yang_34294384_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="assignment4_template_Xinran_Yang_34294384_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="assignment4_template_Xinran_Yang_34294384_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="assignment4_template_Xinran_Yang_34294384_files/libs/bootstrap/bootstrap-c0367b04c37547644fece4185067e4a7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="assignment4_template_Xinran_Yang_34294384_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="assignment4_template_Xinran_Yang_34294384_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Who is Reporting Crime? –An Analysis of NIBRS System Capture Participation Rate Maps Across the U.S.</h1>
<p class="subtitle lead">Assignment 4 ETC5512</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Xinran Yang </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Data and Documenting</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Blog post</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Behind the Scenes</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<section id="question-1" class="level4">
<h4 class="anchored" data-anchor-id="question-1">Question 1</h4>
<p>My question is the distribution of types of law enforcement agencies in each state and their percentage of NIBRS participation and adoption trends. By investigating the types of agencies in each state, the distribution of agency types, the percentage of agency participation in NIBRS reporting, and trends in NIBRS adoption. Crime data changes rapidly on a daily basis and the fluidity of crime can be reflected in this dataset.</p>
</section>
<section id="question-2" class="level4">
<h4 class="anchored" data-anchor-id="question-2">Question 2</h4>
<p><strong>Data Description</strong></p>
<p>The data for this analysis comes from the FBI Crime Data API compiled in <code>tidytuesday</code>. there is agency-level data for all 50 U.S. states. The dataset provides detailed information on law enforcement agencies that have submitted data to the FBI Uniform Crime Reporting (UCR) program and are displayed on the Crime Data Explorer (CDE).</p>
</section>
<section id="question-3" class="level4">
<h4 class="anchored" data-anchor-id="question-3">Question 3</h4>
<p><strong>Readme</strong></p>
<p><code>Author</code>: Xinran Yang</p>
<p><code>Data Source</code>: Official API interface from FBI Crime Data Explorer, collected and maintained by the Federal Bureau of Investigation (FBI).</p>
<p><code>Data Type</code>: administrative census.</p>
<p><code>Source Description</code>: The file <code>aencies.csv</code> is published by the TidyTuesday community and contains basic information about U.S. law enforcement agencies and their participation in the National Incident Based Reporting System (NIBRS).</p>
<p><code>Licience</code>: CC0 1.0 Universal Public Domain Dedication. <a href="https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-02-18/readme.md" class="uri">https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-02-18/readme.md</a></p>
<p><strong>Data privacy</strong></p>
<ul>
<li><p>This dataset contains no personal, case details or identifying information and is entirely agency-level data with no privacy implications.</p></li>
<li><p>The data is provided through the U.S. governments open platform API, which belongs to the public resources, and is used legally and without copyright issues。</p></li>
</ul>
<p><strong>Ethical Considerations</strong></p>
<ul>
<li><p>Oversimplifying the interpretation of the social significance of law enforcement data.</p></li>
<li><p>Making a direct correlation between agency participation in NIBRS and the quality of law enforcement.</p></li>
<li><p>Omitting a misunderstanding of the reasons for missing data.</p></li>
</ul>
<p><strong>data dictionary</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table 1: Data Dictionary for Agencies Dataset</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ori</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Unique ID used to identify an agency.</td>
</tr>
<tr class="even">
<td style="text-align: left;">county</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">The county associated with the agency’s jurisdiction within a state.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">latitude</td>
<td style="text-align: left;">double</td>
<td style="text-align: left;">The approximate latitude of the agency.</td>
</tr>
<tr class="even">
<td style="text-align: left;">longitude</td>
<td style="text-align: left;">double</td>
<td style="text-align: left;">The approximate longitude of the agency.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">state_abbr</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">The abbreviated two letter state code for the agency's location.</td>
</tr>
<tr class="even">
<td style="text-align: left;">state</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">The full name of the state where the agency is located.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">agency_name</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">The official name of the agency.</td>
</tr>
<tr class="even">
<td style="text-align: left;">agency_type</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">The type or category of the agency, such as city or county.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">is_nibrs</td>
<td style="text-align: left;">logical</td>
<td style="text-align: left;">Indicates whether the agency participates in the FBI’s National Incident-Based Reporting System (NIBRS).</td>
</tr>
<tr class="even">
<td style="text-align: left;">nibrs_start_date</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">The date on which the agency began reporting data to NIBRS.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nibrs_year</td>
<td style="text-align: left;">double</td>
<td style="text-align: left;">The year on which the agency began reporting data to NIBRS.</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="question-4" class="level4">
<h4 class="anchored" data-anchor-id="question-4">Question 4</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download dataset</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)    </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite) </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)    </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. Get a FBI Crime Data API Key from the docs here: https://cde.ucr.cjis.gov/LATEST/webapp/#/pages/docApi</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. Set an environment variable via</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. Run the script which will access your environment variable via</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>state_abbrs <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AL"</span>, <span class="st">"AK"</span>, <span class="st">"AZ"</span>, <span class="st">"AR"</span>, <span class="st">"CA"</span>, <span class="st">"CO"</span>, <span class="st">"CT"</span>, <span class="st">"DE"</span>, <span class="st">"FL"</span>, <span class="st">"GA"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"HI"</span>, <span class="st">"ID"</span>, <span class="st">"IL"</span>, <span class="st">"IN"</span>, <span class="st">"IA"</span>, <span class="st">"KS"</span>, <span class="st">"KY"</span>, <span class="st">"LA"</span>, <span class="st">"ME"</span>, <span class="st">"MD"</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MA"</span>, <span class="st">"MI"</span>, <span class="st">"MN"</span>, <span class="st">"MS"</span>, <span class="st">"MO"</span>, <span class="st">"MT"</span>, <span class="st">"NE"</span>, <span class="st">"NV"</span>, <span class="st">"NH"</span>, <span class="st">"NJ"</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"NM"</span>, <span class="st">"NY"</span>, <span class="st">"NC"</span>, <span class="st">"ND"</span>, <span class="st">"OH"</span>, <span class="st">"OK"</span>, <span class="st">"OR"</span>, <span class="st">"PA"</span>, <span class="st">"RI"</span>, <span class="st">"SC"</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SD"</span>, <span class="st">"TN"</span>, <span class="st">"TX"</span>, <span class="st">"UT"</span>, <span class="st">"VT"</span>, <span class="st">"VA"</span>, <span class="st">"WA"</span>, <span class="st">"WV"</span>, <span class="st">"WI"</span>, <span class="st">"WY"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>api_key <span class="ot">&lt;-</span> <span class="st">"1HCS2tzlqdkThSAEbVq9nfNZDaCB7xo9Lia43fs9"</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>parse_nibrs_date <span class="ot">&lt;-</span> <span class="cf">function</span>(date_val) {</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(date_val)) {</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA_character_</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.list</span>(date_val)) {</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(date_val) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">as.character</span>(date_val[[<span class="dv">1</span>]]) <span class="cf">else</span> <span class="cn">NA_character_</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.character</span>(date_val)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>fetch_agency_data <span class="ot">&lt;-</span> <span class="cf">function</span>(state_abbr, api_key) {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://api.usa.gov/crime/fbi/cde/agency/byStateAbbr/%s?API_KEY=%s"</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    state_abbr, api_key</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a> response_text <span class="ot">&lt;-</span> <span class="fu">request</span>(url) <span class="sc">%&gt;%</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req_perform</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">resp_body_string</span>()</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  agency_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(response_text, <span class="at">flatten =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  agency_df <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.data.frame</span>(agency_data)) {</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    agency_data</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.list</span>(agency_data)) {</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(agency_data)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Unexpected JSON structure: not a list or data frame."</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"nibrs_start_date"</span> <span class="sc">%in%</span> <span class="fu">names</span>(agency_df)) {</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    agency_df <span class="ot">&lt;-</span> agency_df <span class="sc">%&gt;%</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">nibrs_start_date =</span> <span class="fu">map_chr</span>(nibrs_start_date, parse_nibrs_date))</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    agency_df<span class="sc">$</span>nibrs_start_date <span class="ot">&lt;-</span> <span class="cn">NA_character_</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  agency_df<span class="sc">$</span>state <span class="ot">&lt;-</span> state_abbr</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  agency_df</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>agency_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>qa_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (state <span class="cf">in</span> state_abbrs) {</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Fetching data for state:"</span>, state, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  state_agency_df <span class="ot">&lt;-</span> <span class="fu">fetch_agency_data</span>(state, api_key)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  agency_data_list[[state]] <span class="ot">&lt;-</span> state_agency_df</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  qa_data_list[[state]] <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> state,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">response_length =</span> <span class="fu">nrow</span>(state_agency_df)</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>agencies <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(agency_data_list) <span class="sc">|&gt;</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agency_type =</span> agency_type_name, <span class="at">county =</span> counties, <span class="at">state =</span> state_name) <span class="sc">|&gt;</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ori, county, latitude, longitude, state_abbr, state, agency_name, agency_type, is_nibrs, nibrs_start_date)</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="co"># QA checks</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>response_qa <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(qa_data_list)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>agencies_qa <span class="ot">&lt;-</span> agencies <span class="sc">%&gt;%</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">%&gt;%</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_ori =</span> <span class="fu">n_distinct</span>(ori), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>qa_comparison <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(response_qa, agencies_qa, <span class="at">by =</span> <span class="st">"state"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">match =</span> response_length <span class="sc">==</span> n_ori) <span class="sc">%&gt;%</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(match <span class="sc">!=</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(qa_comparison)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Data cleansing and checking</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a new variable: NIBRS start-up year</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>agencies <span class="ot">&lt;-</span> agencies <span class="sc">%&gt;%</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nibrs_year =</span> <span class="fu">year</span>(nibrs_start_date))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I have chosen not to store the data locally, because it can be downloaded easily provided there is an internet connection.</p>
</section>
<section id="reference" class="level4">
<h4 class="anchored" data-anchor-id="reference">Reference</h4>
<ul>
<li><p>Ford Johnson. (2025). <em>tidytuesday/data/2025/2025-02-18/readme.md at main · rfordatascience/tidytuesday</em>. GitHub. https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-02-18/readme.md?plain=1</p></li>
<li><p>Grolemund, G., &amp; Wickham, H. (2011). Dates and Times Made Easy withlubridate. <em>Journal of Statistical Software</em>, <em>40</em>(3). https://doi.org/10.18637/jss.v040.i03</p></li>
<li><p>Ooms, J. (2014). The jsonlite Package: A Practical and Consistent Mapping Between JSON Data and R Objects. <em>ArXiv:1403.2805 [Cs, Stat]</em>. https://arxiv.org/abs/1403.2805</p></li>
<li><p>Wickham, H. (2021). <em>httr2: Perform HTTP Requests and Process the Responses</em>. https://doi.org/10.32614/cran.package.httr2</p></li>
<li><p>Wickham, H., François, R., Henry, L., &amp; Müller, K. (2019). A Grammar of Data Manipulation [R package dplyr version 0.8.3]. <em>R-Project.org</em>. https://cran.r-project.org/package=dplyr</p></li>
<li><p>Wickham, H., &amp; Henry, L. (2023). Functional Programming Tools [R package purrr version 1.0.2]. <em>R-Project.org</em>, <em>R package version 1.0.4</em>. https://cran.r-project.org/package=purrr</p></li>
<li><p>Wickham, H., Hester, J., &amp; Bryan, J. (2021). <em>Read Rectangular Text Data [R package readr version 2.0.1]</em>. Cran.r-Project.org. https://cran.r-project.org/package=readr</p></li>
<li><p>Zhu, H. (2021). <em>Construct Complex Table with “kable” and Pipe Syntax [R package kableExtra version 1.3.4]</em>. Cran.r-Project.org. https://cran.r-project.org/package=kableExtra</p></li>
</ul>
<!-- Task 2 Tab: Writing your blogpost -->
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<section id="introduction" class="level4">
<h4 class="anchored" data-anchor-id="introduction">Introduction</h4>
<p>The United States has had a criminal record since its founding, and it has fluctuated greatly over time. Furthermore, as previously reported, crime rates in the United States can vary dramatically depending on geographic location, with some jurisdictions experiencing little to no serious crime and others (particularly those that are more industrialised) experiencing higher numbers.</p>
<p>The two main sources of crime data in the United States are the Federal Bureau of Investigations (FBI) Uniform Crime Reports, which incorporate the eight types of crime recorded by law enforcement, and the Bureau of Justice Statistics (BJS) National Crime Victimisation Survey (NCVS). The primary source of data for this blog is the Uniform Crime Reports from FBI.</p>
</section>
<section id="why-analyze-agencies-from-the-fbi-crime-data" class="level4">
<h4 class="anchored" data-anchor-id="why-analyze-agencies-from-the-fbi-crime-data">Why Analyze Agencies from the FBI Crime Data?</h4>
<p>In recent years, security issues in the United States have received global attention. As a result, there has been public interest in assessing the quality, representativeness, and usefulness of national crime statistics by understanding the structure of law enforcement agencies and their participation in NIBRS. The blog hopes to use this dataset to interpret the data and to be able to identify and understand crime trends in the United States. In turn, the blog hopes to identify security barriers that hinder the development of modern American society.</p>
<p>On a personal note, I had accidentally watched a vlog on Tiktok before that a vlogger visited one of the most dangerous area in the US and was assaulted in a neighbourhood in the US due to some unexpected incident. Meanwhile, I have been planning to travel to the United States, in order to protect my life during the trip, so I would like to know about the safety issues in the United States.</p>
</section>
<section id="where-can-we-get-agencies-from-the-fbi-crime-data" class="level3">
<h3 class="anchored" data-anchor-id="where-can-we-get-agencies-from-the-fbi-crime-data">Where Can We Get Agencies from the FBI Crime Data?</h3>
<p>The FBI crime data can be accessed at <a href="https://cde.ucr.cjis.gov/LATEST/webapp/#/pages/docApi网站进行抓取.">https://cde.ucr.cjis.gov/LATEST/webapp/#/pages/docApi.</a> Below are some of the results of the data captured and subjected to data cleansing:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        ori county latitude longitude state_abbr   state
1 AL0430200    LEE 32.60406 -85.35305         AL Alabama
2 AL0430100    LEE 32.60809 -85.47514         AL Alabama
3 AL0430000    LEE 32.60406 -85.35305         AL Alabama
4 AL0070100   BIBB 33.01589 -87.12715         AL Alabama
5 AL0070000   BIBB 32.94000 -87.11683         AL Alabama
6 AL0070300   BIBB 33.01589 -87.12715         AL Alabama
                     agency_name agency_type is_nibrs nibrs_start_date
1      Opelika Police Department        City     TRUE       2021-01-01
2       Auburn Police Department        City     TRUE       2020-12-01
3    Lee County Sheriff's Office      County     TRUE       2012-04-01
4  Centreville Police Department        City     TRUE       2020-01-01
5   Bibb County Sheriff's Office      County     TRUE       2021-01-01
6 West Blocton Police Department        City     TRUE       2020-01-01
  nibrs_year
1       2021
2       2020
3       2012
4       2020
5       2021
6       2020</code></pre>
</div>
</div>
<p>This data provides information on basic offence data, such as the county, agency, the type of agency, the date of recorded into NIBRS, etc.</p>
<section id="data-analysis" class="level4">
<h4 class="anchored" data-anchor-id="data-analysis">Data Analysis</h4>
<p><strong>Analysing the Distribution of Types of Law Enforcement Agencies by State</strong></p>
<p>As can be seen in <a href="#fig-1" class="quarto-xref">Figure&nbsp;1</a>, City types are the highest number of organizations in almost all U.S. states. Meanwhile, County types are also represented in several states. The number of state police agencies agencies is small but widely distributed. University or College agencies and Unknown types are the least numerous.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assignment4_template_Xinran_Yang_34294384_files/figure-html/fig-1-1.png" class="img-fluid figure-img" data-fig-pos="H" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Distribution of Types of Law Enforcement Agencies by State
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Analysing the Geographic Distribution of Law Enforcement Agencies</strong></p>
<p>According to <a href="#fig-2" class="quarto-xref">Figure&nbsp;2</a>, urban law enforcement agencies are densely distributed in the east and sparsely distributed in the west. Pink dots are especially densely distributed in the Northeast, Midwest, and South. The West (e.g., Nevada, Utah, Colorado) is relatively sparse. County law enforcement agencies are more widely distributed in the Midwest and West. This reflects the uneven distribution of population and cities in the U.S.-the East is densely populated, has many cities, and has a high demand for law enforcement agencies, while the West is sparsely populated and has a low density of law enforcement agencies.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assignment4_template_Xinran_Yang_34294384_files/figure-html/fig-2-1.png" class="img-fluid figure-img" data-fig-pos="H" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Geographic Distribution of Law Enforcement Agencies
</figcaption>
</figure>
</div>
</div>
</div>
<p>To further explore the correlation between population and law enforcement agencies, U.S. Census 2020 data was read and the density of law enforcement agencies per state was calculated, as detailed in <a href="#fig-3" class="quarto-xref">Figure&nbsp;3</a>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        ori county latitude longitude state_abbr   state
1 AL0430200    LEE 32.60406 -85.35305         AL Alabama
2 AL0430100    LEE 32.60809 -85.47514         AL Alabama
3 AL0430000    LEE 32.60406 -85.35305         AL Alabama
4 AL0070100   BIBB 33.01589 -87.12715         AL Alabama
5 AL0070000   BIBB 32.94000 -87.11683         AL Alabama
6 AL0070300   BIBB 33.01589 -87.12715         AL Alabama
                     agency_name agency_type is_nibrs nibrs_start_date
1      Opelika Police Department        City     TRUE       2021-01-01
2       Auburn Police Department        City     TRUE       2020-12-01
3    Lee County Sheriff's Office      County     TRUE       2012-04-01
4  Centreville Police Department        City     TRUE       2020-01-01
5   Bibb County Sheriff's Office      County     TRUE       2021-01-01
6 West Blocton Police Department        City     TRUE       2020-01-01
  nibrs_year total_population
1       2021          5024279
2       2020          5024279
3       2012          5024279
4       2020          5024279
5       2021          5024279
6       2020          5024279</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assignment4_template_Xinran_Yang_34294384_files/figure-html/fig-3-1.png" class="img-fluid figure-img" data-fig-pos="H" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Law Enforcement Density by State (Per 100,000 People)
</figcaption>
</figure>
</div>
</div>
</div>
<p>The darker the colour, the higher the number of law enforcement agencies per 100,000 persons. West Virginia has the darkest colour, and the chart shows it as the state with the highest density of law enforcement agencies. Some Midwestern states (e.g., Nebraska, South Dakota, Vermont) also show high densities. But some of the more populous states such as California, Texas, and Florida are lighter, indicating that while the number of agencies is high, the density is low relative to the population.</p>
<p><strong>Analysing the NIBRS Participation Rate by State</strong></p>
<p>Most state law enforcement agencies in the U.S. have high NIBRS participation rates, with nearly full participation in regions such as the Midwest, South, and New England. Pennsylvania, Florida, Illinois, etc. are light coloured, indicating low collection rates or not yet fully NIBRS-enabled.The United States as a whole is advancing well, but there is a lag in advancement in individual large states.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assignment4_template_Xinran_Yang_34294384_files/figure-html/fig-4-1.png" class="img-fluid figure-img" data-fig-pos="H" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: NIBRS Participation Rate by State
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Analysing the Trend of Agencies Adopting NIBRS Over Time</strong></p>
<p>As evidenced in <a href="#fig-5" class="quarto-xref">Figure&nbsp;5</a>, 1990s - 2015 was a period of slow growth in the number of agencies adopting NIBRS. Beginning in 2016, the number of adoptions rises rapidly, especially in 2019 and 2020, peaking in 2020 with nearly 2,500 law enforcement agencies adopting NIBRS that year.After 2021, the number of new adoptions declines rapidly.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-5" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assignment4_template_Xinran_Yang_34294384_files/figure-html/fig-5-1.png" class="img-fluid figure-img" data-fig-pos="H" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Trend of Agencies Adopting NIBRS Over Time
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="what-can-we-conclude-from-our-analysis-of-agencies-from-the-fbi-crime-data" class="level4">
<h4 class="anchored" data-anchor-id="what-can-we-conclude-from-our-analysis-of-agencies-from-the-fbi-crime-data">What can we conclude from our analysis of Agencies from the FBI Crime Data?</h4>
<p>Law enforcement agencies across the United States show significant interstate differences in density, type, and NIBRS participation rates, and these differences are closely related to the structure and geographic distribution of agencies in each state. Central and Eastern states are dominated by a large number of local agencies with high agency density and generally high NIBRS participation rates, while populous states such as California and Florida have low participation rates despite a large number of agencies, reflecting challenges with integration and data reporting.</p>
<p>Therefore, choosing to travel or reside in cities in the central and eastern United States would provide a relatively high level of security.</p>
</section>
<section id="references" class="level4">
<h4 class="anchored" data-anchor-id="references">References</h4>
<ul>
<li><p>Becker RA, Wilks AR, Brownrigg R, Minka TP, Deckmyn A (2025). _maps: Draw Geographical Maps_. doi: 10.32614/CRAN.package.maps</p></li>
<li><p>Di Lorenzo P (2025). _usmap: US Maps Including Alaska and Hawaii_. doi: 10.32614/CRAN.package.usmap&lt;https://doi.org/10.32614/CRAN.package.usmap&gt;, R package version 0.8.0, &lt;https://CRAN.R-project.org/package=usmap&gt;.</p></li>
<li><p>Grolemund, G., &amp; Wickham, H. (2011). Dates and Times Made Easy withlubridate. <em>Journal of Statistical Software</em>, <em>40</em>(3). https://doi.org/10.18637/jss.v040.i03</p></li>
<li><p>Ooms, J. (2014). The jsonlite Package: A Practical and Consistent Mapping Between JSON Data and R Objects. <em>ArXiv:1403.2805 [Cs, Stat]</em>. https://arxiv.org/abs/1403.2805</p></li>
<li><p>&nbsp; SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). “Welcome to the tidyverse.” _Journal of Open Source Software_, *4*(43), 1686.doi:10.21105/joss.01686&lt;https://doi.org/10.21105/joss.01686&gt;.</p></li>
<li><p>United States Census Bureau. (2025). <em>Explore Census Data</em>. United States Census Bureau. https://data.census.gov/</p></li>
<li><p>Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache</p></li>
<li><p>Wickham, H. (2016). <em>ggplot2: Elegant Graphics for Data Analysis</em>. Tidyverse.org. https://ggplot2.tidyverse.org</p></li>
<li><p>Wickham, H. (2021). <em>httr2: Perform HTTP Requests and Process the Responses</em>. https://doi.org/10.32614/cran.package.httr2</p></li>
<li><p>Wickham, H., &amp; Henry, L. (2023). Functional Programming Tools [R package purrr version 1.0.2]. <em>R-Project.org</em>, <em>R package version 1.0.4</em>. https://cran.r-project.org/package=purrr</p></li>
<li><p>Wickham, H., François, R., Henry, L., &amp; Müller, K. (2019). A Grammar of Data Manipulation [R package dplyr version 0.8.3]. <em>R-Project.org</em>. https://cran.r-project.org/package=dplyr</p></li>
<li><p>Wickham, H., Hester, J., &amp; Bryan, J. (2021). <em>Read Rectangular Text Data [R package readr version 2.0.1]</em>. Cran.r-Project.org. https://cran.r-project.org/package=readr</p></li>
<li><p>Wikipedia Contributors. (2019). <em>Crime in the United States</em>. Wikipedia; Wikimedia Foundation. https://en.wikipedia.org/wiki/Crime_in_the_United_States</p></li>
</ul>
<!-- Task 3 Tab: Behind the Scenes -  -->
</section>
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<section id="question-5" class="level4">
<h4 class="anchored" data-anchor-id="question-5">Question 5</h4>
<p><em>Tell us about parts of your data processing or analysis that weren’t “sexy” and wouldn’t typically be included in a blog post. (e.g.&nbsp;Was their any data drudgery or time intensive wrangling? Were there any repetitive tasks or manual tasks? If it was easy, describe what made it easy?)</em></p>
<p>When reading crime data from US law enforcement agencies, I need to get the FBI crime API. but after getting the api, I still cannot read the data successfully. In the end, I chose to set up the API first, and then read the data.</p>
</section>
<section id="question-6" class="level4">
<h4 class="anchored" data-anchor-id="question-6">Question 6</h4>
<p><em>Were there any challenges that <strong>you</strong> faced in conducting this analysis. These may take the form of data limitations or coding challenges? (e.g.&nbsp;Was there anything in your analysis that you were not anticipating when you started? Did you have to change your intended scope? Did you need to master a new skill? Were there any problems you were proud of solving?)</em></p>
<p>After completing the analysis of the FBI crime data, I decided that all of the analysis was specific to law enforcement agencies and did not correlate to security. Therefore I chose to add readings of census data for each state in the US and analyse it in conjunction with the rationing of population and number of law enforcement agencies. However, due to the complexity of the online census data that could not be combined with the FBI.’s law enforcement agency data, I chose to read the census broadsheets and then have the broadsheets converted into a format that could be combined with the FBI.’s law enforcement agency data.</p>
</section>
<section id="question-7" class="level4">
<h4 class="anchored" data-anchor-id="question-7">Question 7</h4>
<p><em>Tell us about any imperfect parts of your work and how <strong>you</strong> would like to expand or improve this analysis in future? Be clear about any limitations or aspects of your analysis that fell beyond scope.</em></p>
<ol type="1">
<li><p>Lack of Time Dimension</p>
<p>This blog only addresses data from a single point in time and does not show how NIBRS participation rates have changed over time, and therefore does not reflect trends, growth, or the impact of policy changes.</p></li>
<li><p>The types of organisations are not broken down in depth</p>
<p>While the charts in my blog show the number of different types of institutions, the participation of different types of institutions in nibrs is not analysed.</p></li>
<li><p>The maps show where the institutions are located, but I have not been able to further analyse urban-rural differences, proximity to population centres or spatial clustering phenomena, and therefore have not been able to explore deeper patterns of geographical distribution.</p></li>
</ol>
</section>
<section id="question-8" class="level4">
<h4 class="anchored" data-anchor-id="question-8">Question 8</h4>
<p>1st version: Downloading and Documentating your Data Process.</p>
<p>2nd version: Add .Rproj file and add task 1 reference.</p>
<p>3rd version: Add blog introduction, analysis reason and the result of dataset.</p>
<p>4th version: add U.S.A population data, data analysis part and finish task 2.</p>
<p>I have saved my 4 previous versions in Github repo. I have attached web URL as below.</p>
<p><a href="https://github.com/xyan0166/etc5512-assignment4.git" class="uri">https://github.com/xyan0166/etc5512-assignment4.git</a></p>
</section>
</div>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>